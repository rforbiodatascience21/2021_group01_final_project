---
title: "Presentation"
author: "Group_1"
date: "9 5 2021"
output: ioslides_presentation

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(kableExtra)
library(tidyverse)
```

## Introduction
Features in  study by xx et. al 
- Data was pulled on 27. april 2021 and is available at: xx
- Contains information of heart patients from 4 locations: Cleveland, Hungary, Switzerland and Long Beach  

## Goal of study
- Perform visual analysis of data distribution
- Try to predict if patients have heart disease or not according to features in the dataset (PCA, K-means, Binomial regression)

## Materials and methods: Data processing
- Data processing, modeling and creation of presentation was performed in Rstudio Cloud.
- Way of coding follows O'Reillys R for Data Science by Wickham and Grolemund 
- Data wrangling was achieved through _piping_ (`%>%`) 
- Whole project exists at github at: 
https://github.com/rforbiodatascience21/2021_group01_final_project

## Project outline 
- Loading and cleaning data
  - Add location variable 
  - Join data sets 
- Augmentation of data
  - Create categorical variables 
- Analysis and Visualisations
  - Distribution of presence of heart disease across physiological variables.
- Unsupervised analysis
  - PCA
  - K-means clustering
- Supervised classification model
  - Binomial regression 

## Data wrangling and cleaning 
### Data Import
- Modified version of data sets was used
- Identifiers for the variables was not released for raw data 
- 14/76 attributes was used
- The Cleveland database is the only one that has been used by ML researchers to
this date
- Example of raw data collected from Cleveland 

```{r, message = FALSE}
data_raw <- read_csv("../data/_raw/processed.cleveland.data")
print(data_raw, width = 80, n = 4, n_extra = 1)
```

### Data Cleaning 
- Joined together the 4 data frames by xx
- Handling of missing values 
- Number of NAs differed across variables
- Clean small dataset vs large dataset w. NAs
![](/cloud/project/results/04_NA_Bar.png){width=50%}

## Tidying and wrangling data
Data was augmented by creating new more insightful columns
- Created categorical age groups for patients, location, diagnosis of disease, sex, chest pain type, fasting blood sugar,  resting electrocardiographic, exercise induced angina, slope of ST and thal

![](/cloud/project/results/Flowchart_R_presentation.png){width=50%}

## Descriptive data analysis and visualisations
- Distribution according to disease presence
- General thoughts for data composition ( plot over antal med presence/not presence, sex osv)
- Data seems balanced 

![](/cloud/project/results/Heart_attack_dist.png){width=50%}
- general distribution of sex and age 
- vælge nogle af plotsne ud, så det virker som om at vi har en plan 

![](/cloud/project/results/Summary_density_plots.png){width=50%}
```{r, message = FALSE}

load("/cloud/project/results/04_Summary_table.RData")
kable(Summary_table,format = "html", digits = 3)%>%
  kable_styling(font_size = 12)%>%
  column_spec(1:4,width = "1.5cm")%>%
  column_spec(4, width = "2cm")

```

## Descriptive data analysis and visualisations
- Distribution according to disease presence
- First hand biological insights 
- continous plot  
![](/cloud/project/results/04_Summary_bar_plots.png){width=100%}

## Unsupervised learning: Results from PCA 
- Data wrangling and handling of NAs 
- Regions in which the majority of the pool of observations show consistency in presence/absence of disease
- The first three PCs account for ~70% of the total variance
- Indicating that we should be able to separate observations with presence of disease from absence of disease 
![](/cloud/project/results/08_plot_pca.png){width=50%}
![](/cloud/project/results/08_eigenvalues_plot.png){width=50%}

## Unsupervised learning: Kmeans Cluster
- Handling of NA and selection of data 
- Performed on PCA data   
![](/cloud/project/results/08_kmeans.png){width=50%}
![](/cloud/project/results/08_kmeans_dist.png"){width=50%}

## Supervised learning: Prediction model based on presence of heart disease 
- We want to create a model that can identified whether a participant have a heart disease or not based on the age of the participant
- This plot show the distribution of the in age for the different locations in each of the to categories corresponding to having a heart disease or not.
  - There does not seem to be a strong correlation between age of the participant and a heart disease alon based on these plots

![](/cloud/project/results/05_plot_density_of_disease_mutated.png){width=100%}


- Two binomial regression was created:
  - The first binomial Regression model predicts the odds of being diagnosed with a heart disease, given the participants age
  - The first binomial Regression model predicts the odds of being diagnosed with a heart disease, given the participants age, gender and type of chest pain
  
![](/cloud/project/results/05_plot_binomial_regression.png){width=100%}

```{r, echo=FALSE}
load("/cloud/project/results/05_Matrix_conf.RData")
Matrix_conf1 <- Matrix_conf %>%
  select(Model_formular,`True Positive`,`False Positive`,`False Negative`,`True Negative`)
Matrix <- Matrix_conf %>%
  select(Model_formular,accuracy,Precision,Recall,F_score)

kable(Matrix_conf1,format = "html", digits = 3)%>%
  kable_styling(font_size = 14)
kable(Matrix,format = "html", digits = 3)%>%
  kable_styling(font_size = 14)
```

- Based on the result of from the confusion matrix, it intuitively seems that the second is the better predictor model
- This is further illustrated by the result of the in the second table:
  -  The precision estimates how well the model is when the predictions a diagnosis of heart disease
  - The recall estmale how well the model is to correctly predict a diagnosis of hear disease
  - The accuracy is an estimation of how often the model correctly classify a participant.
  - The F score is a is the weighted average that makes comparing model easier.
  - As can be seen in the table the accuracy, precision, recall and F score is higher for the second model, which means the second model is the better model 

## Discussion
### Considerations concerning the data used 
- Missing information as a result of removing rows containing NA
### Biological insights 
- which variables contribute to prediction. 
- Prevalence of symptoms e.g xx is more abundant for patient with heart disease 
- Non of the binomial models are good enough for medical use because 20% to 30% of the patients will be wrongly classified 

## Thank you 
### Questions?
